<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   version="1.0"
   id="magic-keyboard"
   height="100%"
   width="100%"
   viewBox="0 0 570 290"
   inkscape:version="0.91 r13725"
   sodipodi:docname="keyboard-simple-abc.svg">
  <defs>
    <text id="input" ></text>
    <style type="text/css"><![CDATA[
	  svg{
	   background-color :red;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;

	  }
      .key rect {
        fill: rgba(100,100,100,0.5);
        stroke: gold;
        stroke-width: 3;		
      }
	  .key text{
	    font-family: arial;
		stroke: gold;
		fill: gold;
	  }
    ]]></style>
  </defs>
  
  <script type="text/ecmascript"><![CDATA[
  "use strict";
  
	var hasClass = (typeof document.documentElement.classList == "undefined") ?
    function(el, clss) {
        return el.className && new RegExp("(^|\\s)" +
               clss + "(\\s|$)").test(el.className);
    } :
    function(el, clss) {
        return el.classList.contains(clss);
    };
  
	function registerKeys(){
	 console.log("Step 3");
	 let keys = document.getElementsByClassName("key");
	 Array.prototype.forEach.call(keys, function(element) {
		//console.log(element);
		element.addEventListener("touchend",keyKeyed, false);
		//element.addEventListener("click",keyKeyed, false);
	 });
	 
	}
	
        function getKeyTarget(element){
            if (hasClass(element,"key")){
                return element;
            }else if(element.parentNode == document){
                // Safeguard, should not be possible if key register was scoped correctly
                return null;
            }else{
                return element.parentNode;
            }
        }
      
        function addIdentifierCharacter(c){
            //console.log("Char "+c);
            let inputElement = document.getElementById("input");
            inputElement.textContent = inputElement.textContent + c;
            //console.log(inputElement.textContent);
            
        }
        function clearIdentifier(){
            //console.log("Clear");
            let inputElement = document.getElementById("input");
            inputElement.textContent = "";
        }
        function selectIdentifier(){
            console.log("Select");
        }
      
	function keyKeyed(event){
	  let key = getKeyTarget(event.target).id;
          switch(key){
            case "clear" : {
                clearIdentifier();
            } break;
            case "select" : {
                selectIdentifier();
            } break;
            default :
                addIdentifierCharacter(key);
          }
	  //	$(ev.target.parentElement.childNodes).removeClass("key-selected");
	  //	$(ev.target).addClass("key-selected");
	}
 
 
	console.log("Step 1");
	let root = document.getElementById("magic-keyboard");
	root.addEventListener('load', registerKeys, false);
	console.log("Step 2");
 
  ]]></script>
  
  
  <g id="a" class="key letter" transform="translate(10,10)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">A</text>
  </g>  
  <g id="b" class="key letter" transform="translate(80,10)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">B</text>
  </g>
  <g id="c" class="key letter" transform="translate(150,10)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">C</text>
  </g>
  <g id="d" class="key letter" transform="translate(220,10)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">D</text>
  </g>
  <g id="e" class="key letter" transform="translate(290,10)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">E</text>
  </g>
  <g id="f" class="key letter" transform="translate(360,10)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">F</text>
  </g>
  <g id="g" class="key letter" transform="translate(430,10)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">G</text>
  </g>
  <g id="h" class="key letter" transform="translate(500,10)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">H</text>
  </g>
  <g id="i" class="key letter" transform="translate(10,80)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">I</text>
  </g>  
  <g id="j" class="key letter" transform="translate(80,80)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">J</text>
  </g>
  <g id="k" class="key letter" transform="translate(150,80)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">K</text>
  </g>
  <g id="l" class="key letter" transform="translate(220,80)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">L</text>
  </g>
  <g id="m" class="key letter" transform="translate(290,80)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">M</text>
  </g>
  <g id="n" class="key letter" transform="translate(360,80)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">N</text>
  </g>
  <g id="o" class="key letter" transform="translate(430,80)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">O</text>
  </g>
  <g id="p" class="key letter" transform="translate(500,80)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">P</text>
  </g>
  <g id="q" class="key letter" transform="translate(10,150)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">Q</text>
  </g>  
  <g id="r" class="key letter" transform="translate(80,150)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">R</text>
  </g>
  <g id="s" class="key letter" transform="translate(150,150)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">S</text>
  </g>
  <g id="t" class="key letter" transform="translate(220,150)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">T</text>
  </g>
  <g id="u" class="key letter" transform="translate(290,150)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">U</text>
  </g>
  <g id="v" class="key letter" transform="translate(360,150)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">V</text>
  </g>
  <g id="w" class="key letter" transform="translate(430,150)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">W</text>
  </g>
  <g id="x" class="key letter" transform="translate(500,150)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">X</text>
  </g>
  <g id="y" class="key letter" transform="translate(220,220)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">Y</text>
  </g>
  <g id="z" class="key letter" transform="translate(290,220)">
    <rect width="60" height="60" x="0" y="0" ry="10" />
    <text x="25" y="25" text-anchor="end">Z</text>
  </g>
  <g id="clear" class="key command" transform="translate(80,220)">
    <rect width="130" height="60" x="0" y="0" ry="10" />
    <text x="15" y="25" >Clear</text>
  </g>
  <g id="select" class="key command" transform="translate(360,220)">
    <rect width="130" height="60" x="0" y="0" ry="10" />
    <text x="15" y="25" >Select</text>
  </g>
  
</svg>
